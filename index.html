<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Guardian ‚Äì Women Safety</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: radial-gradient(circle at top, #fce7f3, #ede9fe);
            font-family: 'Inter', sans-serif;
        }

        .pulse-sos {
            animation: pulseGlow 2s infinite;
        }

        @keyframes pulseGlow {
            0% { box-shadow: 0 0 0 0 rgba(236,72,153,0.6); }
            70% { box-shadow: 0 0 0 25px rgba(236,72,153,0); }
            100% { box-shadow: 0 0 0 0 rgba(236,72,153,0); }
        }
    </style>
</head>

<body class="min-h-screen flex items-center justify-center">

<div class="w-full max-w-sm px-6">

    <!-- LOGO -->
    <div class="flex flex-col items-center mb-8">
        <div class="w-24 h-24 rounded-full shadow-lg mb-3"
             style="
                background-image: url('data:image/png;base64,PASTE_YOUR_BASE64_LOGO_HERE');
                background-size: cover;
                background-position: center;
             ">
        </div>

        <h1 class="text-2xl font-semibold text-purple-700">Guardian</h1>
        <p class="text-sm text-purple-500">Your invisible safety bubble</p>
    </div>

    <!-- SOS BUTTON -->
    <div class="flex justify-center mb-8">
        <button id="sosBtn"
            class="pulse-sos bg-pink-500 text-white w-40 h-40 rounded-full text-xl font-bold shadow-xl">
            SOS
        </button>
    </div>

    <!-- ACTION BUTTONS -->
    <div class="grid grid-cols-2 gap-4">

        <button onclick="openFakeCall()"
            class="bg-white rounded-2xl p-4 shadow text-purple-600">
            üì± Fake Call
        </button>

        <button onclick="toggleSiren()"
            class="bg-white rounded-2xl p-4 shadow text-purple-600">
            üö® Police Siren
        </button>

        <button onclick="emergencyCall()"
            class="bg-white rounded-2xl p-4 shadow text-purple-600">
            ‚òéÔ∏è Emergency Call
        </button>

        <button onclick="openSettings()"
            class="bg-white rounded-2xl p-4 shadow text-purple-600">
            ‚öôÔ∏è Settings
        </button>

    </div>
</div>

<!-- POLICE SIREN AUDIO -->
<audio id="siren" loop preload="auto">
    <source src="https://assets.mixkit.co/active_storage/sfx/1995/1995-preview.mp3" type="audio/mpeg">
</audio>

<script>
/* =========================
   SOS SINGLE / TRIPLE TAP
========================= */

let tapCount = 0;
let tapTimer = null;
const sosBtn = document.getElementById("sosBtn");

sosBtn.addEventListener("click", () => {
    tapCount++;

    if (tapCount === 1) {
        tapTimer = setTimeout(() => {
            sendSOS("normal");
            tapCount = 0;
        }, 1200);
    }

    if (tapCount === 3) {
        clearTimeout(tapTimer);
        sendSOS("strong");
        tapCount = 0;
    }
});

function sendSOS(type) {
    if (!navigator.geolocation) {
        alert("Geolocation not supported");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        (position) => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const locationLink = `https://www.google.com/maps?q=${lat},${lon}`;

            let message =
                type === "strong"
                ? `üö®üö® EMERGENCY ALERT üö®üö®\nPLEASE HELP IMMEDIATELY!\nüìç ${locationLink}`
                : `üö® SOS ALERT üö®\nI need help.\nüìç ${locationLink}`;

            const contacts =
                JSON.parse(localStorage.getItem("guardianContacts")) ||
                ["918078416898"];

            // WhatsApp allows only ONE redirect
            window.location.href =
                `https://wa.me/${contacts[0]}?text=${encodeURIComponent(message)}`;
        },
        () => alert("Enable GPS to send SOS")
    );
}

/* =========================
   POLICE SIREN
========================= */

let sirenPlaying = false;

function toggleSiren() {
    const siren = document.getElementById("siren");

    if (!sirenPlaying) {
        siren.volume = 1.0;
        siren.play();
        sirenPlaying = true;

        if (navigator.vibrate) {
            navigator.vibrate([500, 300, 500, 300]);
        }
    } else {
        siren.pause();
        siren.currentTime = 0;
        sirenPlaying = false;

        if (navigator.vibrate) {
            navigator.vibrate(0);
        }
    }
}

/* =========================
   NAVIGATION
========================= */

function openFakeCall() {
    window.location.href = "fake-call.html";
}

function openSettings() {
    window.location.href = "settings.html";
}

function emergencyCall() {
    const contacts =
        JSON.parse(localStorage.getItem("guardianContacts")) ||
        ["918078416898"];

    window.location.href = `tel:${contacts[0]}`;
}
</script>

</body>
</html>
